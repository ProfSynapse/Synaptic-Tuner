# Dataset Naming Convention

## Overview

This document defines the naming convention for all datasets in the Toolset-Training project.

## Naming Format

```
{project}_{type}_{quality}_{date}.jsonl
```

### Components

#### 1. Project (`{project}`)
- **`syngen_tools`** - Synthetic tool-calling datasets for Claudesidian-MCP
- **`toolset_training`** - General toolset training data (alternative)

#### 2. Type (`{type}`)
Indicates the training method and data structure:

- **`kto`** - KTO (Kahneman-Tversky Optimization) preference learning
  - Interleaved True/False examples
  - Pattern: True, False, True, False, ...
  - Use for teaching preference between good/bad tool calls

- **`sft`** - Supervised Fine-Tuning
  - Positive examples only (label=true)
  - Direct supervision on correct behavior
  - Use for initial training from scratch

- **`scored`** - Quality-scored dataset
  - Contains quality_scores metadata
  - 5-point rubric across 5 dimensions
  - Use for analysis and quality assessment

- **`reference`** - Reference/baseline dataset
  - Original or unmodified examples
  - Poor-quality examples for comparison
  - Use for analysis and benchmarking

#### 3. Quality (`{quality}`)
Indicates the quality level or processing state:

- **`improved`** - Enhanced examples with:
  - Complete sessionMemory (never empty)
  - Workflow-aware toolContext
  - Complete Result objects
  - Strong goal hierarchies
  - Natural prompts

- **`poor`** - Low-quality examples with:
  - Empty or generic context fields
  - Missing Result objects
  - Weak goal hierarchies
  - Overall quality < 3.0/5.0

- **`baseline`** - Original unmodified dataset
  - No quality improvements applied
  - As generated by teacher models

- **`mixed`** - Contains both improved and poor examples
  - For contrastive learning
  - Not necessarily interleaved

#### 4. Date (`{date}`)
Format: **MM.DD.YY** (e.g., `11.22.25` for November 22, 2025)

- Use date of dataset creation/finalization
- Allows version tracking by date
- Enables easy identification of latest version

## Current Datasets (as of 11.22.25)

### Production Datasets

| Filename | Type | Examples | Purpose |
|----------|------|----------|---------|
| `syngen_tools_kto_improved_11.22.25.jsonl` | KTO (interleaved) | 7,361 | Preference learning training |
| `syngen_tools_sft_improved_11.22.25.jsonl` | SFT (positive) | 3,680 | Supervised fine-tuning |
| `syngen_tools_reference_poor_11.22.25.jsonl` | Reference | 3,681 | Analysis/comparison |

### Legacy Datasets (historical)

| Filename | Type | Examples | Notes |
|----------|------|----------|-------|
| `syngen_tools_sft_11.18.25.jsonl` | SFT | 2,676 | Previous SFT dataset |
| `syngen_tools_11.18.25.jsonl` | KTO | 4,649 | Previous KTO dataset |
| `syngen_tools_11.14.25.jsonl` | Mixed | 4,652 | Earlier version with multi-turn |

## Usage Examples

### For KTO Training (Preference Learning)

```bash
cd Trainers/rtx3090_kto

# Train 7B model with improved interleaved dataset
./train.sh --model-size 7b \
  --local-file ../../Datasets/syngen_tools_kto_improved_11.22.25.jsonl
```

**Why KTO:**
- Teaches model to prefer high-quality over low-quality tool calls
- Requires interleaved True/False pairs
- Best for refining already-trained models
- Learning rate: 2e-7 (very low)

### For SFT Training (Supervised Learning)

```bash
cd Trainers/rtx3090_sft

# Train 7B model with improved positive-only dataset
./train.sh --model-size 7b \
  --local-file ../../Datasets/syngen_tools_sft_improved_11.22.25.jsonl
```

**Why SFT:**
- Teaches model WHAT tool calling is from scratch
- Uses only positive examples (no labels needed)
- Best for initial training
- Learning rate: 2e-4 (100x higher than KTO)

### For Analysis

```bash
# Analyze tool coverage
python tools/analyze_tool_coverage.py \
  Datasets/syngen_tools_sft_improved_11.22.25.jsonl

# Validate dataset
python tools/validate_syngen.py \
  Datasets/syngen_tools_kto_improved_11.22.25.jsonl
```

## Quality Metrics

All `improved` datasets meet these standards:

- ✅ **100% validation pass rate** - All examples pass schema validation
- ✅ **Complete context objects** - All 7 required fields present
- ✅ **Non-empty sessionMemory** - Every example has meaningful prior context
- ✅ **Workflow-aware toolContext** - Explains WHY tool is called
- ✅ **Complete execution** - Result objects showing tool execution
- ✅ **Natural prompts** - Conversational user messages

### Dimension Scores (5-point scale)

| Dimension | Poor (<3.0) | Improved (≥4.0) |
|-----------|-------------|-----------------|
| sessionMemory | 1.99 | 4.0 |
| toolContext | 2.25 | 4.0 |
| goal_coherence | 3.21 | 4.0 |
| prompt_naturalness | 3.62 | 4.0 |
| response_realism | 1.68 | 4.5 |
| **Overall** | **2.55** | **≥4.0** |

## Version History

### v2.0 (11.22.25) - Improved Quality Dataset
- **Total improved:** 3,680 examples
- **Quality improvement:** 2.55 → 4.0+ (+57%)
- **Validation rate:** 100% (up from 91.5%)
- **Key improvements:**
  - Fixed all empty sessionMemory fields
  - Enhanced toolContext with workflow reasoning
  - Added complete Result objects to 98%+ of examples
  - Improved goal hierarchies
  - Naturalized prompts

### v1.0 (11.18.25) - Multi-turn Removed
- Removed multi-turn conversations (caused generic responses)
- Created separate SFT (2,676) and KTO (4,649) datasets
- Single-turn only for focused tool-calling patterns

### v0.9 (11.14.25) - Initial Scoring
- First comprehensive quality review
- 4,652 examples scored across 7 rounds
- Identified 66.7% needing improvement

## Best Practices

### When Naming New Datasets

1. **Use consistent format:** `syngen_tools_{type}_{quality}_{date}.jsonl`
2. **Match type to training method:** kto for KTO, sft for SFT
3. **Indicate quality level:** improved, poor, baseline, or mixed
4. **Use creation date:** MM.DD.YY format
5. **Document in this file:** Add entry to version history

### When Choosing a Dataset

1. **For initial training:** Use SFT with `improved` quality
2. **For refinement:** Use KTO with `improved` interleaved
3. **For analysis:** Use `scored` or `reference` datasets
4. **For comparison:** Use `baseline` or `poor` datasets

### When Creating Variants

- **Filtering:** Add suffix like `_filtered` or `_subset`
- **Tool-specific:** Add prefix like `memoryManager_` or `vaultManager_`
- **Experimental:** Add `_experimental` or `_test` suffix
- **Examples:**
  - `syngen_tools_kto_improved_11.22.25_filtered.jsonl`
  - `memoryManager_sft_improved_11.22.25.jsonl`
  - `syngen_tools_kto_improved_11.22.25_test.jsonl`

## File Locations

### Primary Datasets
- **Location:** `/Datasets/`
- **Format:** JSONL (one JSON object per line)
- **Tracked:** Yes (committed to git)

### Quality Review Artifacts
- **Location:** `/Datasets/quality_review/`
- **Contents:** Scored datasets, analysis reports, improvement batches
- **Tracked:** Partially (main outputs only)

### Intermediate/Temporary
- **Location:** `/Datasets/quality_review/improvement_batches/`
- **Tracked:** No (excluded by .gitignore)
- **Contents:** Batch processing artifacts

## Validation

All datasets should pass validation before being used for training:

```bash
python tools/validate_syngen.py Datasets/{dataset_name}.jsonl
```

Expected output for production datasets:
```
✓ Schema validation enabled (47 tool schemas loaded)
Validated X example(s): 0 failed
```

## Related Documentation

- `/CLAUDE.md` - Main project documentation
- `/Datasets/quality_review/improvement_report.md` - Quality improvement details
- `/Datasets/quality_review/FINAL_VALIDATION_RESULTS.txt` - Validation summary
- `/KTO_TRAINING_REFERENCE.md` - KTO training specifics
- `/Trainers/rtx3090_sft/README.md` - SFT training guide
- `/Trainers/rtx3090_kto/README.md` - KTO training guide

## Changelog

### 2025-11-22
- Established naming convention format
- Created v2.0 improved datasets (11.22.25)
- Achieved 100% validation on KTO dataset
- Documented quality metrics and usage examples

### 2025-11-18
- Created separate SFT and KTO datasets
- Removed multi-turn conversations
- Established date-based versioning

### 2025-11-14
- Initial dataset creation
- Basic naming: `syngen_tools_11.14.25.jsonl`
